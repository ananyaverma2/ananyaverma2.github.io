<!-- ---
layout: default
--- -->
<div class="container">
  <div class="post-title-box">
    <div class="row">
      <div class="col col-10 push-2 col-11 push-t-1 col-m-12 push-m-0">
        <!-- <span class="post__date">
          <time datetime="2022-04-21T00:00:00+02:00">Apr 21, 2022</time>
        </span> -->

        <h1 class="post-title">youBot from scratch</h1>

        <div class="post__info">
          <!-- <div class="post__author">
            <span>By</span>
            <a href="http://localhost:4000/about/" class="author-name">Ananya Verma</a>
          </div> -->

          
          <div class="post__tags">
            
              <a href="http://localhost:4000/tag/project" class="post__tags-tag">PROJECT</a>
            
          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  
    <div class="post__head">
      <div class="post-image" style="background-image: url(http://localhost:4000/images/03.jpg)"></div>
    </div>
  

  </div>


  <div class="container">
  <div class="row">
    <!-- begin post -->
    <article class="post  col col-8 col-t-10 col-m-12">

      <div class="post__content">
        <p>This repository offers a detailed description to perform autonomous navigation using a KUKA youBot controlled via an external Laptop. This work was performed at RoboCup@Work Lab in Hochschule Bonn-Rhein-Sieg.</p>

<h1 id="motivation">Motivation</h1>

<p>The intention behind performing this work is to get in-depth knowledge of <code class="language-plaintext highlighter-rouge">How to configure a robot with ROS from scratch</code>. For this purpose, we have used a <strong>KUKA youBot</strong> and an <strong>external Laptop</strong>.</p>

<h1 id="pre-requisites">Pre-requisites</h1>

<ul>
  <li>
    <p>A KUKA youBot</p>
  </li>
  <li>
    <p>A laptop with the following specifications:</p>
    <ul>
      <li>Ubuntu v18.04</li>
      <li>ROS Melodic Morenia</li>
    </ul>
  </li>
</ul>

<h1 id="steps-to-follow">Steps to follow</h1>

<h2 id="create-a-catkin-workspace">Create a catkin workspace</h2>

<ul>
  <li>First create a workspace, we call it <code class="language-plaintext highlighter-rouge">youBot_from_scratch</code> and then build it.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir youBot_from_scratch
cd youbot_from_scratch
mkdir src
catkin build
cd src
</code></pre></div></div>

<ul>
  <li>
    <p>Inside <code class="language-plaintext highlighter-rouge">src</code>, we now need to clone the following packages:</p>

    <ul>
      <li>
        <p>youbot_driver: <code class="language-plaintext highlighter-rouge">git clone https://github.com/youbot/youbot_driver.git</code></p>
      </li>
      <li>
        <p>youbot_description: <code class="language-plaintext highlighter-rouge">git clone https://github.com/youbot/youbot_description.git</code></p>
      </li>
      <li>
        <p>youbot_driver_ros_interface: <code class="language-plaintext highlighter-rouge">git clone https://github.com/youbot/youbot_driver_ros_interface.git</code></p>
      </li>
      <li>
        <p>youbot_applications: <code class="language-plaintext highlighter-rouge">git clone https://github.com/youbot/youbot_applications.git</code></p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="configuring-hardware">Configuring Hardware</h2>

<blockquote>
  <p>Note: Power the youBot and make sure to turn-off the internal PC.</p>
</blockquote>

<h3 id="kuka-youbot-drivers">KUKA youBot drivers</h3>

<ul>
  <li>
    <p>We’ll install the youBot drivers and test-run the youBot:</p>

    <ul>
      <li>Build the <code class="language-plaintext highlighter-rouge">youbot_driver</code> package:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd youbot_driver
mkdir build
cd build
cmake ..
make
</code></pre></div>    </div>

    <ul>
      <li>
        <p>We need to edit some configuration files in <code class="language-plaintext highlighter-rouge">youbot_driver</code> package:</p>

        <ul>
          <li>
            <p>Connect the ethernet cable from KUKA youBot to your Laptop</p>
          </li>
          <li>
            <p>Check your PC’s Ethernet device ID using <code class="language-plaintext highlighter-rouge">ifconfig</code> (It is usually something like eth0).</p>
          </li>
          <li>
            <p>Go to <code class="language-plaintext highlighter-rouge">config</code> folder inside <code class="language-plaintext highlighter-rouge">youbot_driver</code> package, and open <code class="language-plaintext highlighter-rouge">youbot-ethercat.cfg</code> in edit-mode and change<code class="language-plaintext highlighter-rouge">EthernetDevice = &lt;Your Ethernet Device ID&gt;</code></p>
          </li>
        </ul>
      </li>
      <li>
        <p>Navigate to the <code class="language-plaintext highlighter-rouge">youbot_application</code> package and build it using:</p>
      </li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd youbot_applications
mkdir build
cd build
cmake ..
make
</code></pre></div>    </div>

    <ul>
      <li>Export the respective package paths so that it can be discovered by other packages in ROS:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "export ROS_PACKAGE_PATH=\$ROS_PACKAGE_PATH:/home/&lt;user&gt;/youBot_from_scratch/src/youbot_driver:\
/home/&lt;user&gt;/youBot_from_scratch/src/youbot_applications" &gt;&gt; ~/.bashrc
</code></pre></div>    </div>

    <blockquote>
      <p>Note: Change the <user> tag to your default system user and change the workspace name if different.</user></p>
    </blockquote>

    <ul>
      <li>
        <p>Now we’ll check if the drivers are installed successfully by running a demo script.</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd youbot_applications/hello_world_demo/bin
sudo ./&lt;name_of_binary_file&gt;
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="hokuyo-lidar-sensor">Hokuyo lidar sensor</h3>

<ul>
  <li>
    <p>We’ll integrate the Hokuyo Lidar Sensor with our external laptop:</p>

    <blockquote>
      <p>Note: Since we are using an external laptop instead of KUKA youBot’s internal PC, we need to connect the Hokuyo Lidar sensors to the USB port of the laptop.</p>
    </blockquote>

    <ul>
      <li>
        <p>Connect the sensor to the Laptop and check if the sensor is found by typing <code class="language-plaintext highlighter-rouge">dmesg</code> in a terminal window. Keep a note of its port ID (something like ttyACM0)</p>
      </li>
      <li>
        <p>Check if you have the rights to open the port:</p>
      </li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>od /dev/&lt;port ID&gt;
</code></pre></div>    </div>

    <ul>
      <li>If it doesn’t work, try it with super user permission:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  sudo  od /dev/&lt;port ID&gt;
</code></pre></div>    </div>

    <ul>
      <li>if it works with super user permission, then add yourself to the <code class="language-plaintext highlighter-rouge">dialout</code> group:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  sudo adduser &lt;YOUR_USERNAME&gt; dialout
</code></pre></div>    </div>

    <ul>
      <li>Log out and log back in. Check if you’re in the <code class="language-plaintext highlighter-rouge">dialout</code> group:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  groups
</code></pre></div>    </div>

    <ul>
      <li>Get the device ID/Sensor ID:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun urg_node getID /dev/ttyACM0 --
  
</code></pre></div>    </div>

    <ul>
      <li>
        <p>Write udev rules to give Hokuyo consistent device names:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /etc/udev/rules.d
</code></pre></div>        </div>

        <ul>
          <li>Create a following rule file:</li>
        </ul>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim 80-youBot.rules
</code></pre></div>        </div>

        <ul>
          <li>Paste the following rule and save it:</li>
        </ul>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SUBSYSTEMS=="usb", KERNEL=="ttyACM[0-9]*", ACTION=="add", ATTRS{idVendor}=="15d1", ATTRS{idProduct}=="0000", MODE="666",      PROGRAM="/opt/ros/melodic/lib/urg_node/getID /dev/%k q", SYMLINK+="sensors/hokuyo_%c", GROUP="dialout"
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h2 id="running-youbot-with-ros">Running youBot with ROS</h2>

<ul>
  <li>
    <p>Create a catkin package inside the <code class="language-plaintext highlighter-rouge">src</code> :</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>catkin_create_pkg youBot std_msgs roscpp rospy
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="create-youbot-driver-node">Create youBot driver node</h3>

<ul>
  <li>
    <p>In order to work with youBot, we first need to fire up the youBot drivers:</p>

    <ul>
      <li>Create a launch file <code class="language-plaintext highlighter-rouge">youBot_driver.launch</code> in the <code class="language-plaintext highlighter-rouge">launch</code> directory of the <code class="language-plaintext highlighter-rouge">youBot</code> package and paste the following code:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!launch&gt;
  &lt;include file="$(find youbot_driver_ros_interface)/launch/youbot_driver.launch" /&gt;
&lt;/launch&gt;
</code></pre></div>    </div>
    <blockquote>
      <p>Note: The youBot driver launch file is already provided with the <code class="language-plaintext highlighter-rouge">youbot_driver_ros_interface</code> package. Here, we are simply calling that launch script.</p>
    </blockquote>
  </li>
</ul>

<h3 id="create-youbot-hokuyo-sensor-node">Create youBot Hokuyo sensor node</h3>

<ul>
  <li>
    <p>To visualize the output of Hokuyo Lidar sensor:</p>

    <ul>
      <li>Create a launch file <code class="language-plaintext highlighter-rouge">youBot_sensor.launch</code> in the launch directory of the <code class="language-plaintext highlighter-rouge">youBot package</code> and paste the following code:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;launch&gt;
  &lt;!-- Front Laser scanner--&gt;
  &lt;node name="hokuyo_node_1" pkg="urg_node" type="urg_node" respawn="false" output="screen"&gt;
  &lt;param name="port" type="string" value="/dev/sensors/hokuyo_H1102594"/&gt;
  &lt;param name="intensity" type="bool" value="false"/&gt;
  &lt;param name="min_ang" value="-2.356194437"/&gt;
  &lt;param name="max_ang" value="2.35619443"/&gt;
  &lt;param name="cluster" value="1"/&gt;
  &lt;param name="frame_id" value="base_laser_front_link"/&gt;
  &lt;/node&gt;
  &lt;!-- Back Laser scanner--&gt;	
  &lt;node name="hokuyo_node_2" pkg="urg_node" type="urg_node" respawn="false" output="screen"&gt;
  &lt;param name="port" type="string" value="/dev/sensors/hokuyo_H1838912"/&gt;
  &lt;param name="intensity" type="bool" value="false"/&gt;
  &lt;param name="min_ang" value="-2.356194437"/&gt;
  &lt;param name="max_ang" value="2.35619443"/&gt;
  &lt;param name="cluster" value="1"/&gt;
  &lt;/node&gt; 
  &lt;!-- Launching RViz --&gt;
  &lt;node name="rviz" pkg="rviz" type="rviz"/&gt;
&lt;/launch&gt;
</code></pre></div>    </div>

    <blockquote>
      <p>Note: 1. The value of the parameter <code class="language-plaintext highlighter-rouge">port</code> needs to be change according to your sensor ID (you can find it by navigating to /dev/sensors/hokuyo_xxxxxxx), 2. Depending upon whether you have 1 or 2 hokuyo sensors, you can edit the launch file.</p>
    </blockquote>
  </li>
</ul>

<h3 id="create-youbot-urdf-node">Create youBot urdf node</h3>

<ul>
  <li>
    <p>To import the youBot in RViz,</p>

    <ul>
      <li>Create a launch file <code class="language-plaintext highlighter-rouge">youBot_urdf.launch</code> in the launch directory of the <code class="language-plaintext highlighter-rouge">youBot_package</code> and paste the following code:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;launch&gt;
    &lt;!-- Launching urdf --&gt;
    &lt;param name="robot_description" command="$(find xacro)/xacro --inorder '$(find youbot_description)/robots/youbot.urdf.xacro'" /&gt;    
    &lt;!-- Start TF publishers --&gt;		  
    &lt;node pkg="robot_state_publisher" type="robot_state_publisher" name="robot_base_state_publisher" output="screen" /&gt;
&lt;/launch&gt;
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="create-youbot-teleop-node">Create youBot teleop node</h3>

<ul>
  <li>
    <p>In order to move the youBot around in the workspace, we need to launch teleop package. We’ll be using a Joystick controller to move the robot around.</p>

    <ul>
      <li>Create a launch file <code class="language-plaintext highlighter-rouge">youBot_teleop.launch</code> in the launch directory of the <code class="language-plaintext highlighter-rouge">youBot_package</code> and paste the following code:</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;launch&gt;
    &lt;node pkg="joy" type="joy_node" name="joystick" output="screen"/&gt;
    &lt;node pkg="teleop_twist_joy" type="teleop_node" name="teleop" output="screen"&gt;
    &lt;param name="enable_button" value="5"/&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre></div>    </div>

    <blockquote>
      <p>Note: The parameter <code class="language-plaintext highlighter-rouge">enable_button</code> allows to enable regular-speed movement. We set its value as <code class="language-plaintext highlighter-rouge">5</code> because it is mapped with the <code class="language-plaintext highlighter-rouge">L1</code> Key in Joystick and we use it as a standard key to enable regular-speed movement in all of our KUKA youBot (We have plenty of them!).</p>
    </blockquote>
  </li>
</ul>

<h3 id="create-slam-gmapping-node">Create SLAM gmapping node</h3>

<blockquote>
  <p>Note: In order to do Simultaneous Localization And Mapping, we need to launch the <code class="language-plaintext highlighter-rouge">gmapping</code> package in ROS.</p>
</blockquote>

<ul>
  <li>Create a launch file <code class="language-plaintext highlighter-rouge">youBot_mapping.launch</code> in the launch directory of the <code class="language-plaintext highlighter-rouge">youBot_package</code> and paste the following code:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;launch&gt;
  &lt;node name="slam_gmapping" pkg="gmapping" type="slam_gmapping"&gt;
    &lt;remap from="/scan" to="/scan"/&gt;
    &lt;param name="base_frame" value="base_footprint"/&gt;
  &lt;/node&gt;
&lt;/launch&gt;
</code></pre></div></div>

<h4 id="mapping-the-arena">Mapping ‘the Arena’</h4>

<ul>
  <li>Build the catkin workspace:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  catkin build
</code></pre></div></div>

<ul>
  <li>To start mapping, we need to launch the following launch-files:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`roslaunch youBot youBot_drivers.launch`
`roslaunch youBot youBot_urdf.launch`
`roslaunch youBot youBot_sensor.launch`
`roslaunch youBot youBot_teleop.launch`
`roslaunch youBot youBot_mapping.launch`
</code></pre></div>    </div>
  </li>
  <li>
    <p>Move the youBot around cautiously using the Joystick controller and create a map of the whole arena.</p>
  </li>
  <li>
    <p>After you are done with mapping, you can simply save the map by doing <code class="language-plaintext highlighter-rouge">Ctrl+C</code> in the terminal where you have launched <code class="language-plaintext highlighter-rouge">youBot_mapping</code> node. The map files will be saved in your package.</p>
  </li>
  <li>It’s a good practise, to create a <code class="language-plaintext highlighter-rouge">map</code> directory inside the <code class="language-plaintext highlighter-rouge">youBot</code> package and move both the newly generated files there <code class="language-plaintext highlighter-rouge">&lt;map&gt;.yaml</code> and <code class="language-plaintext highlighter-rouge">&lt;map&gt;.pgm</code>.</li>
</ul>

<h3 id="creating-amcl-node">Creating AMCL Node</h3>

<blockquote>
  <p>Note: In order to do localization, we need to launch the <code class="language-plaintext highlighter-rouge">amcl</code> package in ROS.</p>
</blockquote>

<ul>
  <li>
    <p>Create a launch file <code class="language-plaintext highlighter-rouge">youBot_localization.launch</code> inside the launch directory of the <code class="language-plaintext highlighter-rouge">youBot</code> package and paste the following code:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;launch&gt;
  &lt;!-- MAP Server Node--&gt;
  &lt;arg name="map_file" default="$(find youbot)/map/test_env.yaml"/&gt;
  &lt;node name="map_server" pkg="map_server" type="map_server" args="$(arg map_file)" /&gt;
  &lt;!-- AMCL Node --&gt;
  &lt;node name="amcl" pkg="amcl" type="amcl" output="screen"&gt;
      &lt;remap from="scan" to="/scan"/&gt; &lt;!--according to package--&gt;
      &lt;param name="odom_frame_id" value="odom"/&gt;
      &lt;param name="odom_model_type" value="omni"/&gt;
      &lt;param name="base_frame_id" value="base_footprint"/&gt; &lt;!--according to package--&gt;
      &lt;param name="global_frame_id" value="map"/&gt;
      &lt;!-- If you choose to define initial pose here --&gt;
      &lt;param name="initial_pose_x" value="0"/&gt;
      &lt;param name="initial_pose_y" value="0"/&gt;
      &lt;param name="initial_pose_a" value="0"/&gt;
  &lt;/node&gt; 
&lt;/launch&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>To start localization, we need to launch the following launch-files:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> `roslaunch youBot youBot_drivers.launch`
 `roslaunch youBot youBot_urdf.launch`
 `roslaunch youBot youBot_sensor.launch`
 `roslaunch youBot youBot_teleop.launch`
 `roslaunch youBot youBot_localization.launch`
</code></pre></div>    </div>
    <ul>
      <li>You can move the youBot around and visualize the localization of the youBot in the RViz window by subscribing to appropriate topics.</li>
    </ul>
  </li>
</ul>

<hr />
<p>Todo: Relevant images, rviz config file, navigation</p>

      </div>

      <!-- <div class="post__share">
        <span class="share__title">Share this article:</span>
        <ul class="share__list list-reset">
          <li class="share__item">
            <a class="share__lined" href="https://www.linkedin.com/sharer/sharer.php?u=http://localhost:4000http://localhost:4000/2022/04/21/youBot-from-scratch/"
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
              title="Share on Facebook" rel="nofollow"><i class="ion ion-logo-linkedin"></i></a>
          </li>

          <li class="share__item">
            <a class="share__twitter" href="https://github.com/intent/tweet?text=youBot%20from%20scratch&url=http://localhost:4000http://localhost:4000/2022/04/21/youBot-from-scratch/"
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
              title="Share on Twitter" rel="nofollow"><i class="ion ion-logo-github"></i></a>
          </li>

          <li class="share__item">
            <a class="share__linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000http://localhost:4000/2022/04/21/youBot-from-scratch/&title=youBot%20from%20scratch&summary=&source="
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" rel="nofollow"><i class="ion ion-logo-linkedin"></i></a>
          </li>

          <li class="share__item">
            <a class="share__pinterest" href="http://pinterest.com/pin/create/button/?url=http://localhost:4000/2022/04/21/youBot-from-scratch/&amp;media=http://localhost:4000http://localhost:4000/images/03.jpg&amp;description=youBot%20from%20scratch"
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Pinterest"
              rel="nofollow"><i class="ion ion-logo-pinterest"></i></a>
          </li>
        </ul>
      </div> -->
    </article>
    <!-- end post -->
    </div>
  </div>

  <div class="container">
  <div class="post__navigation">
    
    <div class="prev">
      <a class="post__nav__image" href="http://localhost:4000/2022/04/21/Provenance-Recording-with-ROS2/" style="background-image: url(http://localhost:4000/images/04.jpg)"></a>
      <h2 class="post__nav__title">
        <i class="ion ion-md-arrow-back"></i>
        <a href="http://localhost:4000/2022/04/21/Provenance-Recording-with-ROS2/">Provenance Recording with ROS2</a>
      </h2>
      <p class="prev__excerpt">
        
          This code repo models a running ROS 2 system into its equivalent Prov format (Developed for ROS 2 Eloquent ...
        
      </p>
    </div>
    

    
    <div class="next">
      <a class="post__nav__image" href="http://localhost:4000/2022/05/05/Design-of-a-semantic-parser/" style="background-image: url(http://localhost:4000/images/semantic_title_image.png)">
      </a>
      <h2 class="post__nav__title">
        <a href="http://localhost:4000/2022/05/05/Design-of-a-semantic-parser/">Design of a semantic parser for knowledge representation using existing computer vision output</a>
        <i class="ion ion-md-arrow-forward"></i>
      </h2>
      <p class="next__excerpt">
        
          ## Motivation 
The main goal of this research is to predict the relationships between two objects in an ima...
        
      </p>
    </div>
    
  </div>

  
  </div>
